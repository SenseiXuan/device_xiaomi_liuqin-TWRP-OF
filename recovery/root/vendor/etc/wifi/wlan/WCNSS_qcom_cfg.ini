# WCNSS_qcom_cfg.ini - liuqin (Xiaomi Pad 6 Pro) 专属配置
# WiFi Chip: QCA6490 | 适配 TWRP 16.0 | 仅支持 2.4G/5G 频段
# 核心适配：小米平板固件路径、平板功率限制、国内频段合规、漫游优化

# 基础模式配置（兼容 802.11 a/b/g/n/ac/ax）
gDot11Mode=0
# 固件路径（liuqin QCA6490 官方固件位置）
FirmwarePath=/vendor/firmware_mnt/image/qca6490/

# U-APSD 省电配置（平板续航优化）
InfraUapsdVoSrvIntv=0
InfraUapsdViSrvIntv=0
InfraUapsdBeSrvIntv=0
InfraUapsdBkSrvIntv=0
gAddTSWhenACMIsOff=1

# AP 模式配置
gEnableApOBSSProt=1
RTSThreshold=1048576
gSoftApMaxPeers=10  # 平板热点最大连接数（适配多人共享场景）

# 频段与漫游配置（平板移动场景优化）
g11dSupportEnabled=0
gEnableDFSMasterCap=1
gNeighborScanTimerPeriod=200
gNeighborLookupThreshold=76
FastRoamEnabled=1  # 启用快速漫游
RoamRssiDiff=5    # 漫游信号差值阈值
gRoamThreshold=-70  # 信号低于 -70dBm 自动切换AP
gEnableIEEE80211r=1  # 支持 802.11r 快速漫游（减少断连）
gChannelBondingMode5GHz=1  # 5G 频段信道绑定（80MHz）
gAllowDFSChannelRoam=1  # 允许 DFS 信道漫游（国内合规）
gEnable2GHz=1  # 启用 2.4G 频段（兼容老路由）
gEnable5GHz=1  # 启用 5G 频段（高速传输）
gEnable6GHz=0  # 禁用 6G 频段（liuqin 硬件不支持）
oem_6g_support_disable=1  # 强制禁用 6G 相关功能

# 天线配置（QCA6490 2x2 天线）
gSetTxChainmask1x1=1
gSetRxChainmask1x1=1
gEnable2x2=1  # 启用 2x2 MIMO（提升吞吐量）
gWlanMccToSccSwitchMode=3

# 传输优化配置
gEnableTXSTBC=1
gEnableTxBFeeSAP=1
gEnableTxBFin20MHz=1
gEnableTxSUBeamformer=1
gRrmEnable=1
gVhtAmpduLenExponent=7
gVhtMpduLen=2
isP2pDeviceAddrAdministrated=0
gEnableVhtFor24GHzBand=1
gEnableLpassSupport=1
gCountryCodePriority=1
gWiFiCountryCode=CN  # 中国区频段合规
gEnableMuBformee=1
gTDLSExternalControl=1
gEnableTDLSOffChannel=1
gNumVdevs=5  # 虚拟设备数量（支持 AP+STA 同时工作）

################ Datapath feature set Begin ################
# 数据路径优化（平板大文件传输适配）
gVhtRxMCS=2
gVhtTxMCS=2
gVhtRxMCS2x2=2
gVhtTxMCS2x2=2
gIPAConfig=0
gIPADescSize=800
dp_tx_ring_size=5120
dp_tx_compl_ring_size=8192
dp_tx_desc=8192
dp_tx_ext_desc=8192
rx_mode=20
gEnableFastPath=1  # 启用快速路径（降低延迟）
TSOEnable=1  # 启用 TCP 分段卸载（提升传输效率）
GROEnable=1  # 启用通用接收合并（优化吞吐量）
ght_mpdu_density=5
gEnableFlowSteering=1  # 启用流控（负载均衡）
maxMSDUsPerRxInd=8
gEnableNUDTracking=1
dp_rx_fisa_enable=1
dp_rx_flow_search_table_size=256
dp_rx_fst_in_cmem=1
dp_rx_fisa_lru_del_enable=1
dp_rxdma_buf_ring=4096
dp_rxdma_refill_ring=16384
dp_rx_sw_desc_num=16384
dp_reo_dst_ring=6144
dp_reo_rings_map=0x3F
dp_rx_refill_buff_pool=1
rpsRxQueueCpuMapList=f3
legacy_mode_csum_disable=1
icmp_req_to_fw_mark_interval=200
gBusBandwidthVeryHighThreshold=10000
gRxAggregationSize=1024  # 接收聚合大小（优化大文件传输）
irq_affine_audio_use_case=1
################ Datapath feature set End ################

# 扫描与功耗优化（平板续航优先）
adaptive_dwell_mode_enabled=1
hostscan_adaptive_dwell_mode=1
enable_rtt_mac_randomization=1
gEnableSNRMonitoring=1
gWmiCreditCount=1
acs_with_more_param=1
AutoChannelSelectWeight=0x00fafafa
gRuntimePM=2  # 运行时功耗管理（平衡性能与续航）
gRuntimePMDelay=500  # 功耗管理延迟（避免频繁唤醒）
gEnablePacketLog=0  # 禁用包日志（节省资源）

# 信道扫描时间配置（合规且高效）
active_max_channel_time_2g=80
gActiveMaxChannelTime=60
active_max_channel_time_6g=60  # 仅占位，实际已禁用6G
passive_max_channel_time_6g=60  # 仅占位，实际已禁用6G
gMaxConcurrentActiveSessions=4
enable_mod_dtim_on_system_suspend=1
wlm_latency_flags_xr=0x0000100080083

# BPF 模式配置（安全传输优化）
gActiveMcBcBpfMode=1
gActiveUcBpfMode=2

# 安全与硬件适配补充
gEnableSARSAR=1  # 启用 SAR 辐射控制（平板手持场景合规）
gWiFiChipType=QCA6490  # 明确芯片型号（驱动匹配用）
gEnableWPA3=1  # 支持 WPA3 加密（提升安全性）
gTxPowerLimit=24  # 发射功率上限 24dBm（国内标准，兼顾信号与安全）

END

# Note: Configuration parser would not read anything past the END marker